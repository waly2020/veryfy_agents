<section class="space-y-6 px-4 pb-24 pt-6">
  <header>
    <h1 class="text-2xl font-semibold text-[color:var(--color-veryfy-blue)]">Clients</h1>
  </header>

  <section class="flex items-center justify-end">
    <a
      routerLink="/clients/create"
      class="inline-flex items-center gap-2 rounded-full bg-[color:var(--color-veryfy-blue)] px-4 py-2 text-xs font-semibold uppercase tracking-wide text-white shadow-sm shadow-[color:var(--color-veryfy-blue)]/30"
    >
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-4 w-4">
        <path d="M12 5a1 1 0 0 1 1 1v5h5a1 1 0 1 1 0 2h-5v5a1 1 0 1 1-2 0v-5H6a1 1 0 1 1 0-2h5V6a1 1 0 0 1 1-1Z" />
      </svg>
      Nouveau client
    </a>
  </section>

  <section *ngIf="errorMessage()" class="rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm font-semibold text-rose-700">
    {{ errorMessage() }}
  </section>

  <section *ngIf="isLoading()" class="rounded-2xl border border-slate-100 bg-white px-4 py-3 text-sm text-slate-500 shadow-sm">
    Chargement des clients…
  </section>

  <section
    *ngIf="!isLoading() && !errorMessage() && clients().length === 0"
    class="rounded-2xl border border-dashed border-slate-200 bg-white px-4 py-4 text-sm text-slate-500"
  >
    Aucun client trouvé.
  </section>

  <section class="space-y-3" *ngIf="clients().length">
    <article
      *ngFor="let client of clients()"
      class="rounded-2xl border border-slate-100 bg-white p-4 shadow-sm"
    >
      <div class="flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between">
        <div>
          <h2 class="text-lg font-semibold text-slate-800">
            {{ client.prenom }} {{ client.nom }}
          </h2>
          <p class="text-xs uppercase tracking-wider text-slate-400">
            Client {{ client.type | titlecase }} · ID {{ client.id }}
          </p>
        </div>
        <span
          class="rounded-full px-3 py-1 text-xs font-semibold"
          [ngClass]="client.actif ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-200 text-slate-600'"
        >
          {{ client.actif ? 'Actif' : 'Inactif' }}
        </span>
      </div>

      <dl class="mt-3 grid gap-3 text-xs text-slate-500 sm:grid-cols-2">
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Email</dt>
          <dd>{{ client.email }}</dd>
        </div>
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Téléphone</dt>
          <dd>{{ client.telephone || '—' }}</dd>
        </div>
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Ville</dt>
          <dd>{{ client.ville || '—' }}</dd>
        </div>
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Agent Veryfy</dt>
          <dd>{{ client.agent?.nom }}</dd>
        </div>
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Enrôlé le</dt>
          <dd>
            {{ client.date_enrollement | date: 'mediumDate' : undefined : 'fr-FR' }}
          </dd>
        </div>
        <div class="flex items-center gap-2">
          <dt class="font-semibold text-slate-600">Demandes actives</dt>
          <dd class="font-semibold text-[color:var(--color-veryfy-blue)]">
            {{ client.demandes_actives }}
          </dd>
        </div>
      </dl>

      <footer class="mt-4 rounded-2xl bg-slate-50 p-3 text-xs text-slate-500">
        <p class="font-semibold text-slate-600">Dernière intervention suivie</p>
        <p class="mt-1">
          {{ client.derniere_tache?.titre }}
          <span class="ml-2 rounded-full bg-white px-2 py-0.5 text-[11px] font-semibold text-slate-600">
            {{ client.derniere_tache?.statut | titlecase }} · #{{ client.derniere_tache?.id }}
          </span>
        </p>
      </footer>
    </article>
  </section>
</section>
